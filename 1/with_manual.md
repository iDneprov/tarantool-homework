# Домашнее задание №1 ARCH
## Первое знакомство
* Поставь Tarantool.
  [Инструкция по установке](https://www.tarantool.io/ru/download/os-installation/os-x/).
* Давай для начала посмотрим на структуру базы данных, которую мы будем использовать:  
  ![Формат спейсов](./Structure.png)
  На ней нет связей, вместо этого мы пишем функции, которые на сторадже собирают все необходимые данные.
* Теперь приступим к заданию. Для начала создай три спейса: `magician`, `spell`, `magician_spell`.
  Пример создания спейса `magician`:
```
box.schema.space.create("magician")
```
* Задай формат спейсов, как на картинке.  
  ![формат спейсов](./Structure.png)  
  Ниже примерчик для `magician`
```
box.space.magician:format({
    { name = "id",       type = "number" },
    { name = "name",    type = "string" },
})
```
* Жирным отмечены первичные ключи, к ним нужно привязать индексы как в примере:
```
box.space.magician:create_index('id', { parts = { 'id' } })
```
* К оставшимся полям `magician_spell` тоже нужно привязать индексы.
Советую называть их также, как и поле. Название - это первый параметр `create_index`.
* Вставить трех магов, 5 заклинаний и наполнить спейс связку `magician_spell`.
  Данные для этого находятся ниже.
  Ну и конечно пример вставки:
```
box.space.magician:insert({1, 'Garry'})
```

magician
```
{1, 'Harry'}
{2, 'Petr'}
{3, 'Gandalf'}
```

spell
```
{1, 'Lumos', 'зажигает нематериальный источник света'}
{2, 'Portus', 'открытие портала для перемещения в пространстве'}
{3, 'Reparo', 'восстанавливает сломанные предметы'}
{4, 'Levicorpus', 'подвесить противника в воздухе вниз головой'}
{5, 'Silencio', 'парализует горло противника'}
```

magician_spell
```
{1, 1, 1}
{2, 1, 2}
{3, 1, 3}
{4, 3, 1}
{5, 3, 2}
{6, 3, 3}
{7, 3, 4}
{8, 3, 5}
```

* Напиши функцию, которая выводит список имен всех магов. Чтобы выгрузить их из базы
  используй `box.space.magician:select()`.

* Напиши функцию, которая выведет названия всех заклинаний с четным id при помощи
  функций `len` и `get`.  
  Чтобы узнать сколько в базе записано заклинаний, достаточно ввести
  `box.space.spell:len()`.  
  А чтобы получить первое заклинание - `box.space.spell:get{1}`.

* Выведи список названий заклинаний, которые знает маг с id = 1.
  Чтобы получить индексы заклинаний, тебе понадобится
  `box.space.magician_spell:select({{'=', 'magican_id', 1}})`.

* Испозьзуя `box.space.magician:pairs()` пробегись по `magician` и удали всех
  магов, которые не знают ни одно заклинание. И выведи их имена. Не знаю, как они попали в базу
  магов, но нам срочно нужно от них избавиться! Если нужно будет удалить первого
  мага, достаточно написать `box.space.magician:delete{1}`. Но мне кажется,
  он что-то знает и Гарри лучше оставить.

* Если ты не удалил Гарри, давай переименуем мага с id = 1 в Гарри Поттора:
  `box.space.magician:update({1}, {{'=', 'name', 'Harry Potter'}})`.
